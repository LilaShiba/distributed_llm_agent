version: "3.8"

services:
  router:
    build: ./router
    image: llm-router:latest
    container_name: router
    ports:
      - "8000:5000"
    environment:
      PORT: "5000"
      HOST: "0.0.0.0"
      WORKER_URLS: "http://worker1:5000,http://worker2:5000"
      LOG_LEVEL: "INFO"
    depends_on:
      - worker1
      - worker2

  worker1:
    build: ./worker
    image: llm-worker:latest
    container_name: worker1
    environment:
      PORT: "5000"
      HOST: "0.0.0.0"
      MODEL_NAME: "distilgpt2"
      LOG_LEVEL: "INFO"

  worker2:
    build: ./worker
    image: llm-worker:latest
    container_name: worker2
    environment:
      PORT: "5000"
      HOST: "0.0.0.0"
      MODEL_NAME: "distilgpt2"
      LOG_LEVEL: "INFO"
